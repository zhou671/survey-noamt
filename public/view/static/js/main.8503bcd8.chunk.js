(this["webpackJsonpreact-survey"]=this["webpackJsonpreact-survey"]||[]).push([[0],{102:function(e,t,n){},162:function(e,t,n){},164:function(e,t,n){},166:function(e,t,n){},167:function(e,t,n){},480:function(e,t,n){},481:function(e,t,n){},482:function(e,t,n){"use strict";n.r(t);var c=n(7),i=n.n(c),o=n(28),r=n.n(o),a=(n(162),n(47)),s=n.n(a),l=n(70),u=n(11),j=(n(102),n(8)),b=function(e){var t=e.onRegister,n=Object(c.useState)(""),i=Object(u.a)(n,2),o=i[0],r=i[1];return Object(j.jsxs)("main",{id:"main-holder",children:[Object(j.jsx)("h1",{id:"login-header",children:"Login"}),Object(j.jsx)("p",{children:"Welcome to the perceptual similiarty on 3D shape survey!"}),Object(j.jsx)("p",{children:'Please enter your Amazon Mechanical Turk workId and click on "Enter Survey" to begin or continue. '}),Object(j.jsxs)("form",{id:"login-form",onSubmit:function(e){e.preventDefault(),o?o.length>100?alert("Please enter a userName less than 100 characters"):t(o):alert("Please input your userName")},children:[Object(j.jsx)("input",{type:"text",id:"username-field",class:"login-form-field",placeholder:"UserName",value:o,onChange:function(e){return r(e.target.value)}}),Object(j.jsx)("input",{type:"submit",value:"Continue",id:"login-form-submit"})]})]})},h=n(32),d=function(e){var t=e.text,n=e.onClick;return Object(j.jsx)("button",{onClick:n,id:"login-form-submit",children:t})},f=n(29),m=n(485),O=(n(164),function(e){var t,n=e.object,c=e.orbitRef,i=e.onClick,o=e.model,r=e.render?Object(j.jsx)(d,{text:o,onClick:i}):null,a=[],s=Object(h.a)([[.5773502691896257,-1,-1.5115226281523415],[-1.1547005383792515,0,-1.5115226281523415],[.5773502691896257,1,-1.5115226281523415],[-.9341723589627157,-1.618033988749895,-.35682208977308993],[1.8683447179254313,0,-.35682208977308993],[-.9341723589627157,1.618033988749895,-.35682208977308993],[.9341723589627157,-1.618033988749895,.35682208977308993],[-1.8683447179254313,0,.35682208977308993],[.9341723589627157,1.618033988749895,.35682208977308993],[-.5773502691896257,-1,1.5115226281523415],[1.1547005383792515,0,1.5115226281523415],[-.5773502691896257,1,1.5115226281523415]].entries());try{for(s.s();!(t=s.n()).done;){var l=Object(u.a)(t.value,2),b=(l[0],l[1]);a.push(Object(j.jsx)("pointLight",{position:b,intensity:.1}))}}catch(O){s.e(O)}finally{s.f()}return Object(j.jsxs)("div",{class:"float-child",children:[Object(j.jsxs)(f.a,{camera:{position:[0,0,1],fov:60},children:[Object(j.jsx)(m.a,{ref:c}),a,Object(j.jsxs)("mesh",{position:[0,0,0],children:[Object(j.jsx)("primitive",{object:n}),Object(j.jsx)("meshPhongMaterial",{attach:"material",color:"#ffffff"})]})]}),r]})}),g=n(156),x=[],p=(n(166),function(e){var t=e.onComment,n=Object(c.useState)(""),i=Object(u.a)(n,2),o=i[0],r=i[1];return Object(j.jsxs)("main",{id:"main-holder",children:[Object(j.jsx)("p",{children:"If you have any comments for this survey, please leave it below"}),Object(j.jsxs)("form",{id:"comment-form",onSubmit:function(e){e.preventDefault(),o.length>65536?alert("Please enter a comment less than 65536 characters"):t(o)},children:[Object(j.jsx)("textarea",{id:"username-field",class:"comment-form-field",value:o,onChange:function(e){return r(e.target.value)}}),Object(j.jsx)("input",{type:"submit",value:"Continue",id:"comment-form-submit"})]})]})}),v=(n(167),n(168),n(145)),k=function(e){var t=e.url,n=e.nextseq,i=e.userId,o=e.fileNames,r=e.choiceurl,a=e.uniqueCode,s=e.commenturl,l=Object(c.useState)(0),b=Object(u.a)(l,2),h=b[0],d=b[1],m=Object(c.useState)(n),k=Object(u.a)(m,2),y=k[0],C=k[1],w=Object(c.useState)(void 0),S=Object(u.a)(w,2),P=(S[0],S[1]),I=Object(c.useState)(!1),D=Object(u.a)(I,2),R=D[0],q=D[1],L=Object(c.useState)(!1),T=Object(u.a)(L,2),z=T[0],E=T[1],N=Object(c.useCallback)((function(e){P({current:e}),function(e){e&&(x.push(e),e.addEventListener("change",(function(t){x.forEach((function(n){if(n!==e){var c=t.target.object.position;n.object.position.set(c.x,c.y,c.z);var i=t.target.object.rotation;n.object.rotation.set(i.x,i.y,i.z),n.object.zoom=t.target.object.zoom,n.target=t.target.target,n.object.updateProjectionMatrix()}}))})))}(e)}),[]),F=[];o.forEach((function(e,n,c){"null"===e&&(0!=n&&console.log(c[n-1]),n!=o.length-1&&console.log(c[n+1])),F.push(t+e+"-ori.obj"),F.push(t+e+"-1.obj"),F.push(t+e+"-2.obj")}));var M=Object(f.c)(g.a,F),Y=function(e){return function(){3*h<M.length-3&&v.get(r+i+"/"+y+"/"+e+"/"+o[h]),C(y+1),d(h+1),console.log(h),console.log(M.length),3*h>=M.length-3?E(!0):(M[3*h+0].children.splice(-1),M[3*h+1].children.splice(-1),M[3*h+2].children.splice(-1))}};return z?Object(j.jsx)(p,{onComment:function(e){e.length>0&&v.get(s+e),q(!0),E(!1)}}):R?Object(j.jsxs)("p",{children:[" You have completed all the tasks! Your unique code is ",a,". Thanks for taking this survey! "]}):Object(j.jsxs)("main",{id:"main-holder",children:[Object(j.jsxs)("h1",{id:"login-header",children:["Task ",y," / 55 "]}),Object(j.jsx)("h2",{children:"Does the left or right shape look more similar to the middle one?"}),Object(j.jsx)("p",{children:"*Please drag/zoom the shapes to compare details."}),Object(j.jsx)("div",{class:"float-container",children:[Object(j.jsx)(O,{object:M[3*h+1],orbitRef:N,onClick:Y("1"),model:"Left shape",render:!0}),Object(j.jsx)(O,{object:M[3*h+0],orbitRef:N,onClick:Y("3"),model:"Choose none",render:!1}),Object(j.jsx)(O,{object:M[3*h+2],orbitRef:N,onClick:Y("2"),model:"Right shape",render:!0})]}),Object(j.jsxs)("p",{children:["Failed to load 3d shapes? ",Object(j.jsx)("button",{onClick:Y("3"),id:"text-button",children:" Click here. "})]})]})},y=function(){return Object(j.jsxs)("div",{children:[Object(j.jsx)("h1",{children:"Downloading all 3D shapes which spends about 2 minutes. Here is a timer for 2 minutes."}),Object(j.jsx)("img",{src:"/out.gif",alt:"loadingbar",width:"400",height:"100"})]})},C=(n(480),function(e){var t=e.onClick;return Object(j.jsxs)("main",{id:"main-holder",children:[Object(j.jsx)("h1",{id:"login-header",children:"Instruction"}),Object(j.jsx)("p",{children:" *Please watch the gif below carefully to get familiar with how to interact with 3D shapes."}),Object(j.jsx)("img",{src:"/instruction2.gif",alt:"instruction",width:"900",height:"500"}),Object(j.jsx)("img",{src:"/out.gif",alt:"loadingbar",width:"4",height:"1"}),Object(j.jsx)("button",{onClick:t,id:"btn",children:"Start Survey"})]})}),w=(n(481),n(145)),S=window.location.origin,P=S+"/api/checkuser/",I=S+"/api/getfile/",D=S+"/api/makeselection/",R=S+"/api/getcommet/";var q=function(){var e=Object(c.useState)(!0),t=Object(u.a)(e,2),n=(t[0],t[1]),i=Object(c.useState)(0),o=Object(u.a)(i,2),r=o[0],a=o[1],h=Object(c.useState)(""),d=Object(u.a)(h,2),f=d[0],m=d[1],O=Object(c.useState)(),g=Object(u.a)(O,2),x=g[0],p=g[1],v=Object(c.useState)(0),S=Object(u.a)(v,2),q=S[0],L=S[1],T=Object(c.useState)(""),z=Object(u.a)(T,2),E=z[0],N=z[1],F=function(){var e=Object(l.a)(s.a.mark((function e(t){var c,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.get(P+t);case 2:c=e.sent,i=c.data,m(t),a(parseInt(i.nextId)),p(i.fileName),N(i.uniqueCode),L(1),n(!1);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return function(){try{var e=document.createElement("canvas");return!!window.WebGLRenderingContext&&(e.getContext("webgl")||e.getContext("experimental-webgl"))}catch(t){return!1}}()?0===q?Object(j.jsx)("body",{children:Object(j.jsx)(b,{onRegister:F})}):1===q?r>=55?Object(j.jsxs)("p",{children:[" You have completed all the tasks! Your unique code is ",E,". Thanks for taking this survey! "]}):Object(j.jsx)("body",{children:Object(j.jsx)(C,{onClick:function(){L(2)}})}):Object(j.jsx)("body",{children:Object(j.jsx)(c.Suspense,{fallback:Object(j.jsx)(y,{}),children:Object(j.jsx)(k,{url:I,nextseq:r,userId:f,fileNames:x,choiceurl:D,uniqueCode:E,commenturl:R})})}):Object(j.jsx)("body",{children:"This survey needs support of webgl, please either switch a brower or enable webgl."})},L=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,486)).then((function(t){var n=t.getCLS,c=t.getFID,i=t.getFCP,o=t.getLCP,r=t.getTTFB;n(e),c(e),i(e),o(e),r(e)}))};r.a.render(Object(j.jsx)(i.a.StrictMode,{children:Object(j.jsx)(q,{})}),document.getElementById("root")),L()}},[[482,1,2]]]);
//# sourceMappingURL=main.8503bcd8.chunk.js.map